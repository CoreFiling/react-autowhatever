from __future__ import absolute_import

import json
import os
import shutil

from decimate.projects import repositoryImport, Status
from decimate.projects.emailnotify import EmailTestConfiguration
from decimate.projects.git import GitTestConfiguration
from decimate.projects.statuspublishing import StatusPublishingProject, StatusPublishingTestConfiguration
from decimate.projects.filespublishing import FilesPublishingTestConfiguration
from decimate.projects.otherbuilds import OtherBuildsTestConfiguration


cflSvn = "https://svn-dev.int.corefiling.com/svn/"
thisRepo = "https://github.com/CoreFiling/react-autowhatever.git"
projectBranch = "cfl"
appGitUrl = {
    "repos": thisRepo,
    "branch": projectBranch,
    "to": "react-Autowhatever",
}
emailAddresses = ["cake-ui-fires@corefiling.com"]

repositoryImport("git", "https://gitlab.int.corefiling.com/decimate/decimate-contrib-docker.git", "docker.py", names=["DockerImageBuildConfiguration"], branch="master")
repositoryImport("svn", cflSvn, "devel/decimate/sharedConfigs/trunk/cfl.py", names=["ExpiringArchiveTestConfiguration"])
repositoryImport('git', 'https://gitlab.int.corefiling.com/cfl-gulp-lib/decimate.git', 'npm.py', names=['NpmTestConfiguration'], branch='master')


class CakeUIProject(StatusPublishingProject):
    name = "Cake UI npm builds"
    category = "PD/Cake"

    def getTestConfigurations(self):
        configs = [
            ReactAutowhateverBuild("React-Autowhatever Build", projectBranch, platform="linux2"),
        ]
        return configs


class Base(EmailTestConfiguration):
    emailAddresses = emailAddresses


class ReactAutowhateverBuild(Base, NpmTestConfiguration, ExpiringArchiveTestConfiguration):
    appGitUrl = appGitUrl
    checkForOutdatedPackages = False